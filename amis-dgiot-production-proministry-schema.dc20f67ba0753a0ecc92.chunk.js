/*!
 * build: 杭州数蛙科技有限公司 
 *  copyright: dgiot 
 *  project : dgiot-amis-dashboard 
 *  version : 0.0.2 
 *  description : dgiot-amis-dashboard 脚手架 
 *  author: h7ml(h7ml@qq.com) 
 *  time:Sat Jul 02 2022 17:24:37 GMT+0800 (China Standard Time)
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{HZ3q:function(e,t,l){"use strict";l.r(t),l.d(t,"schema",(function(){return k}));var a=l("ejTr"),i=l.n(a),o=l("CvqZ"),d=l.n(o),n=l("8Vev"),x=l.n(n),r=l("NDYa"),h=l.n(r),b=l("aNQX"),p=l.n(b),m=l("04Ix"),u=l.n(m),c=(l("07d7"),l("FZtP"),l("TSYQ")),g=l.n(c),s=l("p46w"),w=l.n(s),f=l("w5tg"),y=l("c+yx");function v(e,t){var l=i()(e);if(d.a){var a=d()(e);t&&(a=x()(a).call(a,(function(t){return h()(e,t).enumerable}))),l.push.apply(l,a)}return l}function _(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?v(Object(l),!0).forEach((function(t){u()(e,t,l[t])})):p.a?Object.defineProperties(e,p()(l)):v(Object(l)).forEach((function(t){Object.defineProperty(e,t,h()(l,t))}))}return e}var k={type:"page",data:{roleId:"${rows[0].objectId}",departmentId:localStorage.getItem("departmentId")},body:[{type:"grid",columns:[{md:12,body:[{mode:"inline",name:"title",type:"static",label:"生产计划",labelClassName:"text-lg p-md font-bold"}],columnClassName:"bg-white"},{body:[{icon:"fa fa-plus pull-left",type:"button",actionType:"dialog",label:"新建",level:"primary",className:"m-b-sm",dialog:{closeOnEsc:!0,actions:[{label:"取消",actionType:"close",type:"button"},{label:"提交",actionType:"confirm",type:"button",level:"primary"}],body:{api:{method:"post",url:"/iotapi/amis/Device",requestAdaptor:function(e){var t={};console.log("roleid",Object(y.c)()),t[Object(y.c)()]={read:!0,write:!0},t["role:浙江保舒康"]={read:!0,write:!1},console.log("测试",e);var l=[],a=e.data.content,i={label:localStorage.getItem("nick"),objectId:Object(y.c)()};return l.push(i),a.personlist=l,a.imageUrl="http://121.5.171.21:1250"+e.data.myUrl,delete e.data.myUrl,console.log("image",a.image),_(_({},e),{},{data:_(_({},e.data),{},{ACL:t,content:a,detail:{payout:"未派发"},devaddr:"GDH".concat(Object(y.g)()),isEnable:!0,profile:{},route:{},product:{className:"Product",objectId:"d5f1b2dcd8",__type:"Pointer"}})})}},body:[{name:"content.material",type:"select",label:"产出物料",searchable:!0,source:{method:"get",url:"/iotapi/amis/Dict",convertKeyToPath:!0,data:{keys:"objectId,title,data",where:{parent:"bb7d4be836"}},responseData:{options:"${items|pick:label~data.name,value~data}"}},required:!1},{name:"content.code",type:"select",label:"唯一码",searchable:!0,source:{method:"get",url:"/iotapi/amis/Dict",convertKeyToPath:!0,data:{keys:"objectId,title,data",where:{parent:"c7d3f249d2"}},responseData:{options:"${items|pick:label~data.name,value~data}"}}},{type:"input-file",name:"content.image",label:"图片上传",receiver:{url:"/upload",method:"post",requestAdaptor:function(e){console.log("文件上传内容",e,e.data[0]);var t=e.data,l={file:""};t.forEach((function(e,t){return l[t]=e})),console.log(l);var a=w.a.get("authorization")||"";console.log("token",a);var i=new FormData;return i.append("file",l.file),i.append("scene","default"),i.append("filename",""),i.append("output","json"),i.append("path",""),i.append("code",""),i.append("auth_token",a),i.append("submit","upload"),console.log("data内容",i),_(_({},e),{},{data:i})},adaptor:function(e,t,l){return _(_({},e),{},{status:0,msg:"ok"})}},autoFill:{myUrl:"${path}"}},{type:"input-text",name:"myUrl",label:"url",disabledOn:"${false}"},{name:"content.name",type:"input-text",label:"工单名称",required:!0},{name:"content.desc",type:"input-text",label:"描述",required:!0},{name:"content.unit",type:"select",label:"计量单位",searchable:!0,source:{method:"get",url:"/iotapi/amis/Dict",convertKeyToPath:!0,data:{keys:"objectId,title,data",where:{parent:"e201133194"}},responseData:{options:"${items|pick:label~data.name,value~data}"}},required:!1},{name:"content.priority",type:"select",label:"优先级",searchable:!0,source:{method:"get",url:"/iotapi/amis/Dict",convertKeyToPath:!0,data:{keys:"objectId,title,data",where:{parent:"5c96f31928"}},responseData:{options:"${items|pick:label~data.name,value~data}"}},required:!1},{name:"content.step",type:"nested-select",label:"工艺步骤",selectMode:"tree",source:{method:"get",url:"/iotapi/relation",data:{destClass:"_Role",destId:localStorage.getItem("departmentId"),destField:"views",srcClass:"View"},adaptor:function(e,t,l){var a=e.data.rows[0].data.body[0].options;return e.data={},e.data.options=a,_(_({},e),{},{status:0,msg:"ok"})}}},{name:"content.doctime",type:"input-date",label:"单据日期",inputClassName:"w-md",value:"today",format:"YYYY-MM-DD",required:!0},{name:"content.starttime",type:"input-datetime",placeholder:"计划开始时间",label:"计划开始时间",inputClassName:"w-md",value:"now",format:"YYYY-MM-DD HH:mm:ss",required:!0},{name:"content.endtime",type:"input-datetime",maxDate:"${endtime}",placeholder:"计划结束时间",label:"计划结束时间",inputClassName:"w-md",value:"+1day",format:"YYYY-MM-DD HH:mm:ss",required:!0},{name:"content.number",type:"input-number",label:"数量",value:1,required:!0}],type:"form"},title:"产出信息"}},{type:"crud",mode:"table",api:{method:"get",url:"/iotapi/classes/Device",adaptor:function(e,t,l){return console.log("payloadtree",e),{data:{count:e.data.count,rows:e.data.rows,number:"11111"},status:0,msg:"ok"}}},defaultParams:{skip:0,limit:10,order:"-createdAt",count:"objectId",where:{product:"d5f1b2dcd8"}},pageField:"skip",perPageField:"limit",filter:{body:[{mode:"inline",name:"where.devaddr.$regex",size:"md",type:"input-text",placeholder:"按单据号查询"},{name:"where.content.starttime.$gt",type:"input-datetime",placeholder:"起始时间",inputClassName:"w-md",format:"YYYY-MM-DD hh:mm:ss"},{name:"where.content.starttime.$lt",type:"input-datetime",placeholder:"结束时间",inputClassName:"w-md",format:"YYYY-MM-DD hh:mm:ss"},{label:"查询",level:"primary",type:"submit",size:"md"},{label:"重置",type:"reset",size:"md"}],title:"",submitText:""},rowClassNameExpr:"<%= data.detail.payout !=='已派发'? 'bg-light' : '' %>",columns:[{name:"devaddr",label:"单据编号"},{name:"content.code.code",label:"单据类型"},{name:"content.code.code",label:"唯一码"},{name:"content.doctime",label:"单据日期",width:100},{name:"content.isstart",label:"单据状态"},{name:"content.type",label:"产品类型"},{name:"content.material.code",label:"物料编码"},{name:"content.material.name",label:"物料名称"},{name:"content.basedata.model",label:"规格型号"},{name:"content.workshop",label:"生产车间"},{name:"content.unit.name",label:"单位"},{name:"content.number",label:"数量"},{name:"content.compnum",label:"已完成"},{name:"detail.payout",label:"业务状态",width:80},{name:"content.priority.name",label:"需求优先级"},{name:"content.number",label:"领料状态"},{name:"content.step",label:"工艺步骤"},{name:"content.personel.label",label:"派发人员"},{type:"operation",label:"操作",fixed:"right",width:190,buttons:[{type:"button",label:"查看",drawer:{body:{body:[{name:"devaddr",type:"input-text",label:"订单号",extractValue:!0,required:!0},{name:"content.material.name",type:"input-text",label:"产出物料",searchable:!0,extractValue:!0,required:!0},{name:"content.code.code",type:"input-text",label:"唯一码",disabledOn:"${false}"},{name:"content.step",type:"input-text",label:"工艺步骤",value:"content.step",labelField:"label",valueField:"label",selectMode:"tree",required:!0},{name:"content.starttime",type:"input-text",label:"起始时间"},{name:"content.endtime",type:"input-text",label:"结束时间"},{name:"content.number",type:"input-text",label:"计划数量",required:!0},{mode:"inline",name:"title1",type:"static",label:"人员过程",value:"",labelClassName:"text-lg p-md font-bold"},{type:"crud",source:"${content.personlist}",syncLocation:!1,columns:[{name:"objectId",label:"编号"},{name:"label",label:"姓名"}]}],type:"form"},title:"查看"},actionType:"drawer"},{type:"button",label:"派发",level:"success",actionType:"dialog",dialog:{title:"派发任务",body:{type:"form",className:g()(f.b.flex_label5x),api:{method:"put",url:"/iotapi/amis/Device/${objectId}",requestAdaptor:function(e){console.log("api数据查看",e.data);var t=e.data.ACL;for(var l in t)t[l].write&&1==t[l].write&&(t[l].write=!1);t[e.data.dept.objectId]={read:!0,write:!0},console.log("setAcl",t);var a=e.data.content,i=a.personlist;return a.personel=e.data.dept,i.push(e.data.dept),a.personlist=i,a.compnum=0,a.isstart="未开始",a.taskList=[],a.tag=1,_(_({},e),{},{data:{content:a,ACL:t,detail:{payout:"已派发"},isEnable:!0,profile:{},route:{},product:{className:"Product",objectId:"d5f1b2dcd8",__type:"Pointer"}}})}},controls:[{type:"static",name:"content",label:"唯一码",visibleOn:"false"},{name:"ACL",type:"input-text",visibleOn:"false",label:"权限"},{name:"dept",type:"select",label:"派发人员",selectMode:"tree",source:{method:"get",url:"/iotapi/usertree",responseData:{options:"${options|pick:label~label,value~value,children~children}"},adaptor:function(e,t,l){return console.log("payloadtree",e),_(_({},e),{},{status:0,msg:"ok"})}},required:!0}]}},visibleOn:"detail.payout!=='已派发'"},{api:{method:"delete",url:"/iotapi/amis/Device/${objectId}",headers:{sessionToken:w.a.get("authorization")}},type:"button",label:"删除",level:"danger",actionType:"ajax",confirmText:"确认要删除？"},{type:"button",label:"任务",level:"info",drawer:{body:{body:[{mode:"inline",name:"title1",type:"static",label:"任务完成详情",value:"",labelClassName:"text-lg p-md font-bold"},{type:"crud",source:"${content.taskList}",syncLocation:!1,headerToolbar:["export-excel"],columns:[{name:"dingdan",label:"订单号",groupName:"${devaddr}"},{name:"pname",label:"品名",groupName:"${devaddr}"},{name:"date",label:"日期",groupName:"${devaddr}"},{name:"long",label:"长",groupName:"${devaddr}"},{name:"width",label:"宽",groupName:"${devaddr}"},{name:"height",label:"高",groupName:"${devaddr}"},{name:"kweight",label:"克重",groupName:"${devaddr}"},{name:"mweight",label:"毛重",groupName:"${devaddr}"},{name:"mweight",label:"接头数",groupName:"${devaddr}"},{name:"check",label:"品检",groupName:"${devaddr}"},{name:"fenqie",label:"分切",groupName:"${devaddr}"}]}],type:"form"},size:"xl",title:"查看任务详情"},actionType:"drawer",visibleOn:"detail.payout=='已派发'"}]}],headerToolbar:["export-excel"],footerToolbar:["switch-per-page",{align:"left",type:"pagination"}],perPageAvailable:[10,20,50,100,200],alwaysShowPagination:!0,syncLocation:!1}]}]}],style:{backgroundColor:""},messages:{}};console.log("打印schema",k)},w5tg:function(e,t,l){"use strict";var a,i,o,d,n,x;l.d(t,"c",(function(){return a})),l.d(t,"e",(function(){return i})),l.d(t,"d",(function(){return o})),l.d(t,"b",(function(){return n})),l.d(t,"a",(function(){return x})),function(e){e.Inline_Block="global-inline-block",e.MB_None="mb-none"}(a||(a={})),function(e){e.width_full="global-width-full",e.width_unset="global-width-unset",e.width1x="global-width-1x",e.width2x="global-width-2x",e.width3x="global-width-3x",e.width4x="global-width-4x",e.width5x="global-width-5x",e.width6x="global-width-6x",e.width7x="global-width-7x",e.width8x="global-width-8x",e.width9x="global-width-9x",e.width10x="global-width-10x",e.width11x="global-width-11x",e.width12x="global-width-12x",e.width13x="global-width-13x",e.width14x="global-width-14x",e.width15x="global-width-15x",e.width16x="global-width-16x",e.width17x="global-width-17x",e.width18x="global-width-18x",e.width19x="global-width-19x",e.width20x="global-width-20x",e.width21x="global-width-21x",e.width22x="global-width-22x",e.width23x="global-width-23x",e.width24x="global-width-24x",e.width25x="global-width-25x",e.width26x="global-width-26x",e.width27x="global-width-27x",e.width28x="global-width-28x",e.width29x="global-width-29x",e.width30x="global-width-30x",e.width31x="global-width-31x",e.width32x="global-width-32x",e.width33x="global-width-33x",e.width34x="global-width-34x",e.width35x="global-width-35x",e.width36x="global-width-36x",e.width37x="global-width-37x",e.width38x="global-width-38x",e.width39x="global-width-39x",e.width40x="global-width-40x",e.width41x="global-width-41x",e.width42x="global-width-42x",e.width43x="global-width-43x",e.width44x="global-width-44x",e.width45x="global-width-45x",e.width46x="global-width-46x",e.width47x="global-width-47x",e.width48x="global-width-48x"}(i||(i={})),function(e){e.height_full="global-height-full",e.height_unset="global-height-unset",e.height1x="global-height-1x",e.height2x="global-height-2x",e.height3x="global-height-3x",e.height4x="global-height-4x",e.height5x="global-height-5x",e.height6x="global-height-6x",e.height7x="global-height-7x",e.height8x="global-height-8x",e.height9x="global-height-9x",e.height10x="global-height-10x",e.height11x="global-height-11x",e.height12x="global-height-12x",e.height13x="global-height-13x",e.height14x="global-height-14x",e.height15x="global-height-15x",e.height16x="global-height-16x",e.height17x="global-height-17x",e.height18x="global-height-18x",e.height19x="global-height-19x",e.height20x="global-height-20x",e.height21x="global-height-21x",e.height22x="global-height-22x",e.height23x="global-height-23x",e.height24x="global-height-24x"}(o||(o={})),d||(d={}),function(e){e.label2x="form-label-2x",e.label3x="form-label-3x",e.label4x="form-label-4x",e.label5x="form-label-5x",e.label6x="form-label-6x",e.label7x="form-label-7x",e.label8x="form-label-8x",e.label9x="form-label-9x",e.label10x="form-label-10x",e.input10x="form-input-10x",e.input12x="form-input-12x",e.input14x="form-input-14x",e.input16x="form-input-16x",e.input18x="form-input-18x",e.input20x="form-input-20x",e.input22x="form-input-22x",e.input24x="form-input-24x",e.input26x="form-input-26x",e.input28x="form-input-28x",e.input30x="form-input-30x",e.input32x="form-input-32x",e.flex_label2x="flex-form-label-2x",e.flex_label3x="flex-form-label-3x",e.flex_label4x="flex-form-label-4x",e.flex_label5x="flex-form-label-5x",e.flex_label6x="flex-form-label-6x",e.flex_label7x="flex-form-label-7x",e.flex_label8x="flex-form-label-8x",e.flex_label9x="flex-form-label-9x",e.flex_label10x="flex-form-label-10x",e.flex_label12x="flex-form-label-12x",e.flex_label14x="flex-form-label-14x",e.flex_label16x="flex-form-label-16x",e.flex_input10x="flex-form-input-10x",e.flex_input12x="flex-form-input-12x",e.flex_input14x="flex-form-input-14x",e.flex_input16x="flex-form-input-16x",e.flex_input18x="flex-form-input-18x",e.flex_input20x="flex-form-input-20x",e.flex_input22x="flex-form-input-22x",e.flex_input24x="flex-form-input-24x",e.flex_input26x="flex-form-input-26x",e.flex_input28x="flex-form-input-28x",e.flex_input30x="flex-form-input-30x",e.flex_input32x="flex-form-input-32x",e.item_height2_5x="form-item-height-2_5x",e.item_height3_5x="form-item-height-3_5x"}(n||(n={})),function(e){e.width10x="dialog-width-10x",e.width15x="dialog-width-15x",e.width20x="dialog-width-20x",e.width25x="dialog-width-25x",e.width30x="dialog-width-30x",e.width35x="dialog-width-35x",e.width40x="dialog-width-40x",e.width45x="dialog-width-45x",e.width50x="dialog-width-50x",e.width55x="dialog-width-55x",e.width60x="dialog-width-60x",e.width65x="dialog-width-65x",e.width70x="dialog-width-70x",e.width75x="dialog-width-75x",e.width80x="dialog-width-80x",e.width85x="dialog-width-85x",e.width90x="dialog-width-90x",e.width95x="dialog-width-95x",e.width100x="dialog-width-100x",e.width105x="dialog-width-105x",e.width110x="dialog-width-110x",e.width115x="dialog-width-115x",e.width120x="dialog-width-120x",e.width125x="dialog-width-125x",e.width130x="dialog-width-130x",e.width135x="dialog-width-135x",e.width140x="dialog-width-140x",e.width145x="dialog-width-145x",e.width150x="dialog-width-150x"}(x||(x={}))}}]);